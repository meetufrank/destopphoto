<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>预览</title>
<meta name="description" content="">
<meta name="keywords" content="">
<link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>
<script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<style>
html,body{
	margin:0;
	padding:0;
	width:100%;
	height:100%;
}  
body{
	background:url("__UPLOAD__/img/hkbg01.jpg");
	background-size:cover;
	background-repeat:no-repeat;
	background-position:center;
	overflow: hidden;
}
.box{
	width:100%;
	height:100%;
	overflow: hidden;
}
.mybutton{
	background-color: transparent;
    border: 2px solid white;
}
.contain{ 
	width:75%;
    height:65%;
	margin: 0 auto;
	text-align:center;
	margin-top:25%;
}   
.inner_contain{ 
	height: 100%;
	background:url("{$bgimg}");
	background-repeat:no-repeat;
	background-size:100% 100%;

}
.inner_contains{ 
	margin-top:2%;
	margin-bottom:0px;
	margin-left:0px;
	margin-right:0px;   
    width: 100%;
    height:75%;
}
.inner_contains img{
	width: 100%;
	height: 100%;
}
.bottom-button{
	position: absolute;
    text-align: center;
    margin-top: 5px;
    width: 100%;
    bottom:10%;
    z-index: 9999;
}
/*hk06图做背景样式*/
.contain-s{
	width:100%;
    height:45%;
	margin: 0 auto;
	margin-top:45%; 
}
.contain-main{
	padding:0;
}
.contain-main{
	height: 100%;
	background:url("{$bgimg}");
	background-repeat:no-repeat;
	background-size:100% 100%;
        
}
.contain-main-s{ 
	width:75%;
    height:70%;
    margin-top:10%;
/*    border: 1px solid white;
    background-color: red;*/
}
.contain-main-s img{
	width: 100%;
	height: 100%;
}
/*hk05做背景样式*/
.contain-top{
	width:100%;
    height:45%;
	margin: 0 auto;
	margin-top:45%; 
}
.contain-top-main{
	padding: 0;
}
.contain-top-main{
	height: 100%;
	background:url("{$bgimg}");
	background-repeat:no-repeat;
	background-size:100% 100%;
}
.contain-top-main-s{ 
	width:100%;
    height:65%;
    margin:2% 0;
    position: relative;
    /*    border: 1px solid white;
    background-color: red;*/
}
.contain-top-main-s img{
	width: 100%;
	height: 100%;
}
</style>
</head>
<body>
<div class="box">
    {if condition="$bgtype eq 1"}
	<!-- bg01 05 07 07背景图-->
<div class="contain">  
    <div class="inner_contain col-xs-12" id="bginfo">
    	<div class="inner_contains" id="imginfo"> 
    		<img src="{$imgurl}">
    	</div> 
    </div>  
</div>
        {/if}
<div class="bottom-button">
	<button class="btn btn-primary mybutton" onclick="upload();">确认上传</button>
	<button class="btn btn-primary mybutton" onclick="backpage();">返回上页</button>
</div>
         {if condition="$bgtype eq 2"}
<!-- bg04宽背景图 -->
<div class="contain-s">  
	<div class="contain-main col-xs-12" id="bginfo">
		<div class="contain-main-s" id="imginfo"> 
    		<img src="{$imgurl}" class="col-xs-12">
    	</div> 
	</div>
</div>
{/if}
{if condition="$bgtype eq 3"}
<!-- bg03背景图 -->
<div class="contain-top">  
	<div class="contain-top-main col-xs-12" id="bginfo">
		<div class="contain-top-main-s" id="imginfo"> 
    		<img src="{$imgurl}" class="col-xs-12">
    	</div> 
	</div>
</div>
{/if}
</div>
<script>
	function nextpage(){
		window.location.href="{:url('Index/index9')}";
	}
	function backpage(){
		window.location.href="{:url('Index/cropper')}";
	}
     function upload(){
        var bg= $("#bginfo");
        
        var imgs=$("#imginfo img");
        var bt=parseInt($("#imginfo").css('margin-top'));
        var bl=parseInt($("#imginfo").css('margin-left'));
        var pl=parseInt(imgs.css('padding-left'));
        var pt=parseInt(imgs.css('padding-top'));
        var bgwidth=bg.outerWidth();
        var bgheight=bg.outerHeight();
        var width=imgs.width();
        var height=imgs.height();
        var y=imgs.position().top+pt+bt;
        var x=imgs.position().left+pl+bl;
        var bgurl='{$bgimg}';
        var imgurl='{$imgurl}';
        

         $.ajax({
              url:"{:url(\'Index/makeimg\')}",
              data:{bgwidth:bgwidth,bgheight:bgheight,width:width,height:height,x:x,y:y,bgurl:bgurl,imgurl:imgurl},
              dataType:'json',
              success:function(re){
                  if(re){
                      
                  
                  if(re.code==1){
                    window.location.href="{:url('Index/index9')}";      
                  }else{
                      alert(re.msg);
                  }
                                    
                 }
                 }
               });
        
     }
</script>
</body>
</html>